<!DOCTYPE html>
<html lang="fa" id="html-element">
<head>
  <meta charset="UTF-8">
  <title>Ø¨Ø§Ø²Ø§Ø± Ø§ÙØºØ§Ù†Ø³ØªØ§Ù† | Ø®Ø§Ù†Ù‡</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- PWA Meta Tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Ø¨Ø§Ø²Ø§Ø± Ø§ÙØºØ§Ù†Ø³ØªØ§Ù†">
  <meta name="theme-color" content="#302b63">
  <meta name="msapplication-TileColor" content="#0f0c29">

  <!-- Description and Keywords -->
  <meta name="description" content="Ø¨Ø§Ø²Ø§Ø± Ø§ÙØºØ§Ù†Ø³ØªØ§Ù† - Ø¨Ø²Ø±Ú¯ØªØ±ÛŒÙ† Ø¨Ø§Ø²Ø§Ø± Ø¢Ù†Ù„Ø§ÛŒÙ† Ú©Ø´ÙˆØ± Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ùˆ ÙØ±ÙˆØ´ Ø§Ù…Ù„Ø§Ú©ØŒ Ø®ÙˆØ¯Ø±ÙˆØŒ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ Ùˆ Ø³Ø§ÛŒØ± Ú©Ø§Ù„Ø§Ù‡Ø§">
  <meta name="keywords" content="Ø¨Ø§Ø²Ø§Ø±, Ø§ÙØºØ§Ù†Ø³ØªØ§Ù†, Ø¢Ú¯Ù‡ÛŒ, Ø®Ø±ÛŒØ¯, ÙØ±ÙˆØ´, Ø§Ù…Ù„Ø§Ú©, Ø®ÙˆØ¯Ø±Ùˆ, Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ">

  <style>
    body {
      margin: 0;
      font-family: 'Tahoma', sans-serif;
      direction: rtl;
      color: #f0f0f0;
      padding: 20px;
      min-height: 100vh;
      background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
    }

    body.ltr {
      direction: ltr;
    }

    body.pashto {
      font-family: 'Tahoma', 'Afghan Sans', sans-serif;
    }

    .section-box {
      background-color: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      padding: 20px;
      margin-bottom: 30px;
      backdrop-filter: blur(8px);
    }

    .section-box h2 {
      margin-top: 0;
      color: #ffffff;
      font-size: 22px;
      border-bottom: 1px solid rgba(255,255,255,0.3);
      padding-bottom: 10px;
    }

    .nav-bar {
      display: flex;
      gap: 25px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .nav-bar a {
      text-decoration: none;
      font-weight: bold;
      color: #ffffff;
      padding: 8px 14px;
      border-radius: 8px;
      background-color: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.3);
      box-shadow: 2px 2px 6px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }

    .nav-bar a:hover {
      background-color: #ffffff;
      color: #6a11cb;
      border-color: #ffffff;
    }

    .circle-list {
      display: flex;
      gap: 20px;
      overflow-x: auto;
      padding-top: 10px;
    }

    .circle-item {
      min-width: 100px;
      height: 100px;
      background: radial-gradient(circle at top left, #ffffff, #e0e0e0);
      border-radius: 50%;
      box-shadow: 6px 6px 12px #d1d1d1, -6px -6px 12px #ffffff;
      text-align: center;
      padding-top: 20px;
      font-size: 26px;
      font-weight: bold;
      color: #333;
      transition: transform 0.3s;
      cursor: pointer;
    }

    .circle-item:hover {
      transform: scale(1.1);
      background: linear-gradient(to bottom, #00c6ff, #007bff);
      color: white;
    }

    .circle-item span {
      display: block;
      margin-top: 5px;
      font-size: 18px;
    }

    .search-form {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: center;
      margin-top: 10px;
    }

    .search-form input {
      flex: 2;
      padding: 10px;
      font-size: 16px;
      border: 2px solid #ffffff;
      border-radius: 8px;
      background-color: rgba(255,255,255,0.2);
      color: #fff;
    }

    .search-form input::placeholder {
      color: rgba(255,255,255,0.7);
    }

    .search-form select {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      border: 2px solid #ffffff;
      border-radius: 8px;
      background-color: rgba(255,255,255,0.2);
      color: #fff;
    }

    .search-form select option {
      background-color: #2a2a2a;
      color: #fff;
    }

    .search-form button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #ffffff;
      color: #6a11cb;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      font-weight: bold;
    }

    .search-form button:hover {
      background-color: #f0f0f0;
    }

    .top-tools {
      position: fixed;
      top: 15px;
      right: 15px;
      display: flex;
      gap: 10px;
      z-index: 999;
    }

    .top-tools button {
      padding: 8px 14px;
      border: none;
      border-radius: 20px;
      background-color: rgba(255,255,255,0.2);
      color: white;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }

    .top-tools button:hover {
      background-color: rgba(255,255,255,0.4);
    }

    body.dark-mode {
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 50%, #3a3a3a 100%);
    }

    /* Results Grid */
    .results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .card {
      background-color: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      padding: 15px;
      transition: all 0.3s ease;
      cursor: pointer;
      user-select: none;
    }

    .card:hover {
      background-color: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }

    .card:active {
      transform: translateY(0px);
      background-color: rgba(255, 255, 255, 0.2);
    }

    .card .title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #ffffff;
    }

    .card .meta {
      font-size: 14px;
      color: rgba(255,255,255,0.8);
      margin-bottom: 10px;
      line-height: 1.4;
    }

    .card .price {
      font-size: 16px;
      font-weight: bold;
      color: #00ff88;
      margin-bottom: 8px;
    }

    .loading {
      text-align: center;
      padding: 20px;
      color: rgba(255,255,255,0.7);
    }

    .no-results {
      text-align: center;
      padding: 40px;
      color: rgba(255,255,255,0.7);
      font-size: 18px;
    }

    .recent-items-section {
      margin-top: 30px;
    }

    @media (max-width: 768px) {
      .search-form {
        flex-direction: column;
      }

      .search-form input, .search-form select {
        flex: 1;
        width: 100%;
      }

      .circle-item {
        min-width: 90px;
        height: 90px;
        font-size: 22px;
        padding-top: 15px;
      }

      .circle-item span {
        font-size: 16px;
        margin-top: 3px;
      }

      .top-tools {
        flex-direction: column;
        gap: 5px;
      }

      .results-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

  <div class="top-tools">
    <button onclick="location.href='index.html'">ğŸ  <span id="home-btn">Ø®Ø§Ù†Ù‡</span></button>
    <button onclick="location.href='login.php'">ğŸ” <span id="login-btn">ÙˆØ±ÙˆØ¯ / Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</span></button>
    <select id="language-selector" onchange="setLanguage(this.value)">
      <option value="fa">ÙØ§Ø±Ø³ÛŒ</option>
      <option value="ps">Ù¾Ø´ØªÙˆ</option>
      <option value="en">English</option>
    </select>
    <button onclick="toggleTheme()">ğŸŒ™ <span id="theme-btn">Ø­Ø§Ù„Øª</span></button>
  </div>

  <!-- Ø¬Ø³ØªØ¬Ùˆ -->
  <div class="section-box">
    <h2 id="search-title">Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ø¨Ø§Ø²Ø§Ø±</h2>
    <form class="search-form" onsubmit="handleSearch(event)">
      <input type="text" placeholder="Ú†ÛŒ Ù…ÛŒâ€ŒÚ¯Ø±Ø¯ÛŒØŸ" id="searchInput">
      <select id="categorySelect">
        <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</option>
        <option value="vehicles">ÙˆØ³Ø§ÛŒØ· Ù†Ù‚Ù„ÛŒÙ‡</option>
        <option value="realestate">Ø§Ù…Ù„Ø§Ú©</option>
        <option value="electronics">Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ</option>
        <option value="jewelry">Ø¬ÙˆØ§Ù‡Ø±Ø§Øª</option>
        <option value="mens-clothes">Ù„Ø¨Ø§Ø³ Ù…Ø±Ø¯Ø§Ù†Ù‡</option>
        <option value="womens-clothes">Ù„Ø¨Ø§Ø³ Ø²Ù†Ø§Ù†Ù‡</option>
        <option value="kids-clothes">Ù„Ø¨Ø§Ø³ Ø§Ø·ÙØ§Ù„</option>
        <option value="books">Ø¢Ù…ÙˆØ²Ø´</option>
        <option value="kids">Ù„ÙˆØ§Ø²Ù… Ú©ÙˆØ¯Ú©</option>
        <option value="home">Ù„ÙˆØ§Ø²Ù… Ø®Ø§Ù†Ú¯ÛŒ</option>
        <option value="jobs">Ø§Ø³ØªØ®Ø¯Ø§Ù…</option>
        <option value="services">Ø®Ø¯Ù…Ø§Øª</option>
        <option value="games">Ø³Ø±Ú¯Ø±Ù…ÛŒ</option>
        <option value="sports">ÙˆØ±Ø²Ø´ÛŒ</option>
      </select>
      <button type="submit">ğŸ” <span id="search-btn">Ø¬Ø³ØªØ¬Ùˆ</span></button>
    </form>
  </div>

  <!-- Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ -->
  <div class="section-box">
    <h2 id="categories-title">Ù‡Ù…Ù‡ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</h2>
    <div class="circle-list">
      <div class="circle-item" onclick="searchByCategory('vehicles')">ğŸš—<span id="vehicles-cat">ÙˆØ³Ø§ÛŒØ· Ù†Ù‚Ù„ÛŒÙ‡</span></div>
      <div class="circle-item" onclick="searchByCategory('realestate')">ğŸ <span id="realestate-cat">Ø§Ù…Ù„Ø§Ú©</span></div>
      <div class="circle-item" onclick="searchByCategory('electronics')">ğŸ“±<span id="electronics-cat">Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ</span></div>
      <div class="circle-item" onclick="searchByCategory('jewelry')">ğŸ’<span id="jewelry-cat">Ø¬ÙˆØ§Ù‡Ø±Ø§Øª</span></div>
      <div class="circle-item" onclick="searchByCategory('mens-clothes')">ğŸ‘”<span id="mens-clothes-cat">Ù„Ø¨Ø§Ø³ Ù…Ø±Ø¯Ø§Ù†Ù‡</span></div>
      <div class="circle-item" onclick="searchByCategory('womens-clothes')">ğŸ‘—<span id="womens-clothes-cat">Ù„Ø¨Ø§Ø³ Ø²Ù†Ø§Ù†Ù‡</span></div>
      <div class="circle-item" onclick="searchByCategory('kids-clothes')">ğŸ‘¶<span id="kids-clothes-cat">Ù„Ø¨Ø§Ø³ Ø§Ø·ÙØ§Ù„</span></div>
      <div class="circle-item" onclick="searchByCategory('books')">ğŸ“š<span id="books-cat">Ø¢Ù…ÙˆØ²Ø´</span></div>
      <div class="circle-item" onclick="searchByCategory('kids')">ğŸ§¸<span id="kids-cat">Ù„ÙˆØ§Ø²Ù… Ú©ÙˆØ¯Ú©</span></div>
      <div class="circle-item" onclick="searchByCategory('home')">ğŸ›‹ï¸<span id="home-cat">Ù„ÙˆØ§Ø²Ù… Ø®Ø§Ù†Ú¯ÛŒ</span></div>
      <div class="circle-item" onclick="searchByCategory('jobs')">ğŸ’¼<span id="jobs-cat">Ø§Ø³ØªØ®Ø¯Ø§Ù…</span></div>
      <div class="circle-item" onclick="searchByCategory('services')">ğŸ› ï¸<span id="services-cat">Ø®Ø¯Ù…Ø§Øª</span></div>
      <div class="circle-item" onclick="searchByCategory('games')">ğŸ®<span id="games-cat">Ø³Ø±Ú¯Ø±Ù…ÛŒ</span></div>
      <div class="circle-item" onclick="searchByCategory('sports')">âš½<span id="sports-cat">ÙˆØ±Ø²Ø´ÛŒ</span></div>
    </div>
  </div>

  <!-- Ø´Ù‡Ø±Ù‡Ø§ÛŒ Ø§ÙØºØ§Ù†Ø³ØªØ§Ù† -->
  <div class="section-box">
    <h2 id="cities-title">Ø´Ù‡Ø±Ù‡Ø§ÛŒ Ø§ÙØºØ§Ù†Ø³ØªØ§Ù†</h2>
    <div class="circle-list">
      <div class="circle-item" onclick="searchCity('kabul')">ğŸ›ï¸<span id="kabul-city">Ú©Ø§Ø¨Ù„</span></div>
      <div class="circle-item" onclick="searchCity('herat')">ğŸ•Œ<span id="herat-city">Ù‡Ø±Ø§Øª</span></div>
      <div class="circle-item" onclick="searchCity('mazar')">ğŸº<span id="mazar-city">Ù…Ø²Ø§Ø± Ø´Ø±ÛŒÙ</span></div>
      <div class="circle-item" onclick="searchCity('kandahar')">ğŸœï¸<span id="kandahar-city">Ù‚Ù†Ø¯Ù‡Ø§Ø±</span></div>
      <div class="circle-item" onclick="searchCity('jalalabad')">ğŸ”ï¸<span id="jalalabad-city">Ø¬Ù„Ø§Ù„â€ŒØ¢Ø¨Ø§Ø¯</span></div>
      <div class="circle-item" onclick="searchCity('ghazni')">ğŸ°<span id="ghazni-city">ØºØ²Ù†ÛŒ</span></div>
      <div class="circle-item" onclick="searchCity('bamyan')">â›°ï¸<span id="bamyan-city">Ø¨Ø§Ù…ÛŒØ§Ù†</span></div>
      <div class="circle-item" onclick="searchCity('farah')">ğŸŒ¾<span id="farah-city">ÙØ±Ø§Ù‡</span></div>
      <div class="circle-item" onclick="searchCity('kunduz')">ğŸŒ¿<span id="kunduz-city">Ú©Ù†Ø¯Ø²</span></div>
      <div class="circle-item" onclick="searchCity('badakhshan')">ğŸ”ï¸<span id="badakhshan-city">Ø¨Ø¯Ø®Ø´Ø§Ù†</span></div>
    </div>
  </div>

  <!-- Ø¢Ø®Ø±ÛŒÙ† Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡ -->
  <div class="section-box recent-items-section">
    <h2 id="recent-title">Ø¢Ø®Ø±ÛŒÙ† Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡</h2>
    <div id="loadingMessage" class="loading">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§...</div>
    <div id="resultsGrid" class="results-grid"></div>
  </div>

  <!-- Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø¨Ø§Ø²Ø§Ø± -->
  <div class="section-box">
    <h2 id="about-title">Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ Ø¨Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø§ÙØºØ§Ù†Ø³ØªØ§Ù†</h2>
    <p id="about-text" style="line-height: 1.8; font-size: 16px;">
      Ø¨Ø²Ø±Ú¯ØªØ±ÛŒÙ† Ø¨Ø§Ø²Ø§Ø± Ø¢Ù†Ù„Ø§ÛŒÙ† Ø§ÙØºØ§Ù†Ø³ØªØ§Ù† Ú©Ù‡ Ø¯Ø± Ø¢Ù† Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù‡Ø± Ú†ÛŒØ²ÛŒ Ú©Ù‡ Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒØ¯. 
      Ø§Ø² Ø§Ù…Ù„Ø§Ú© Ùˆ ÙˆØ³Ø§ÛŒÙ„ Ù†Ù‚Ù„ÛŒÙ‡ Ú¯Ø±ÙØªÙ‡ ØªØ§ Ù„ÙˆØ§Ø²Ù… Ø®Ø§Ù†Ú¯ÛŒØŒ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ Ùˆ ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ø´ØºÙ„ÛŒ.
    </p>
    <p id="about-text2" style="line-height: 1.8; font-size: 16px;">
      Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø³ÛŒØ³ØªÙ… Ø¬Ø³ØªØ¬ÙˆÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ùˆ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„ØŒ Ø¨Ù‡ Ø±Ø§Ø­ØªÛŒ Ø¢Ù†Ú†Ù‡ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒØ¯.
    </p>
  </div>

  <!-- ÙÙˆØªØ± Ø³Ø§Ø¯Ù‡ Ø¨Ø§ Ù„ÛŒÙ†Ú© ØµÙØ­Ø§Øª -->
  <div style="text-align:center; margin-top:40px; padding:20px; border-top:1px solid rgba(255,255,255,0.3);">
    <p style="margin:0;">
      <a href="about.html" style="color:#fff; text-decoration:none; margin:0 10px;" id="footer-about">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</a> |
      <a href="contact.html" style="color:#fff; text-decoration:none; margin:0 10px;" id="footer-contact">ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§</a> |
      <a href="privacy.html" style="color:#fff; text-decoration:none; margin:0 10px;" id="footer-privacy">Ù‚ÙˆØ§Ù†ÛŒÙ† Ùˆ Ø­Ø±ÛŒÙ… Ø®ØµÙˆØµÛŒ</a> |
      <a href="feedback.html" style="color:#fff; text-decoration:none; margin:0 10px;" id="footer-feedback">Ø§Ø±Ø³Ø§Ù„ Ù†Ø¸Ø±Ø§Øª</a> |
      <a href="search.php" style="color:#fff; text-decoration:none; margin:0 10px;" id="footer-search">Ø¬Ø³ØªØ¬Ùˆ</a> |
      <a href="add_item.php" style="color:#fff; text-decoration:none; margin:0 10px;" id="footer-add">Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ</a>
    </p>
  </div>

  <script>
    let currentLang = 'fa';
    const resultsGrid = document.getElementById('resultsGrid');
    const loadingMessage = document.getElementById('loadingMessage');

    const translations = {
      fa: {
        'home-btn': 'Ø®Ø§Ù†Ù‡',
        'login-btn': 'ÙˆØ±ÙˆØ¯ / Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…',
        'lang-btn': 'Ø²Ø¨Ø§Ù†',
        'theme-btn': 'Ø­Ø§Ù„Øª',
        'search-title': 'Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ø¨Ø§Ø²Ø§Ø±',
        'search-btn': 'Ø¬Ø³ØªØ¬Ùˆ',
        'categories-title': 'Ù‡Ù…Ù‡ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§',
        'cities-title': 'Ø´Ù‡Ø±Ù‡Ø§ÛŒ Ø§ÙØºØ§Ù†Ø³ØªØ§Ù†',
        'recent-title': 'Ø¢Ø®Ø±ÛŒÙ† Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡',
        'about-title': 'Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ Ø¨Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø§ÙØºØ§Ù†Ø³ØªØ§Ù†',
        'vehicles-cat': 'ÙˆØ³Ø§ÛŒØ· Ù†Ù‚Ù„ÛŒÙ‡',
        'realestate-cat': 'Ø§Ù…Ù„Ø§Ú©',
        'electronics-cat': 'Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ',
        'jewelry-cat': 'Ø¬ÙˆØ§Ù‡Ø±Ø§Øª',
        'mens-clothes-cat': 'Ù„Ø¨Ø§Ø³ Ù…Ø±Ø¯Ø§Ù†Ù‡',
        'womens-clothes-cat': 'Ù„Ø¨Ø§Ø³ Ø²Ù†Ø§Ù†Ù‡',
        'kids-clothes-cat': 'Ù„Ø¨Ø§Ø³ Ø§Ø·ÙØ§Ù„',
        'books-cat': 'Ø¢Ù…ÙˆØ²Ø´',
        'kids-cat': 'Ù„ÙˆØ§Ø²Ù… Ú©ÙˆØ¯Ú©',
        'home-cat': 'Ù„ÙˆØ§Ø²Ù… Ø®Ø§Ù†Ú¯ÛŒ',
        'jobs-cat': 'Ø§Ø³ØªØ®Ø¯Ø§Ù…',
        'services-cat': 'Ø®Ø¯Ù…Ø§Øª',
        'games-cat': 'Ø³Ø±Ú¯Ø±Ù…ÛŒ',
        'sports-cat': 'ÙˆØ±Ø²Ø´ÛŒ',
        'kabul-city': 'Ú©Ø§Ø¨Ù„',
        'herat-city': 'Ù‡Ø±Ø§Øª',
        'mazar-city': 'Ù…Ø²Ø§Ø± Ø´Ø±ÛŒÙ',
        'kandahar-city': 'Ù‚Ù†Ø¯Ù‡Ø§Ø±',
        'jalalabad-city': 'Ø¬Ù„Ø§Ù„â€ŒØ¢Ø¨Ø§Ø¯',
        'ghazni-city': 'ØºØ²Ù†ÛŒ',
        'bamyan-city': 'Ø¨Ø§Ù…ÛŒØ§Ù†',
        'farah-city': 'ÙØ±Ø§Ù‡',
        'kunduz-city': 'Ú©Ù†Ø¯Ø²',
        'badakhshan-city': 'Ø¨Ø¯Ø®Ø´Ø§Ù†',
        'about-text': 'Ø¨Ø²Ø±Ú¯ØªØ±ÛŒÙ† Ø¨Ø§Ø²Ø§Ø± Ø¢Ù†Ù„Ø§ÛŒÙ† Ø§ÙØºØ§Ù†Ø³ØªØ§Ù† Ú©Ù‡ Ø¯Ø± Ø¢Ù† Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù‡Ø± Ú†ÛŒØ²ÛŒ Ú©Ù‡ Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒØ¯. Ø§Ø² Ø§Ù…Ù„Ø§Ú© Ùˆ ÙˆØ³Ø§ÛŒÙ„ Ù†Ù‚Ù„ÛŒÙ‡ Ú¯Ø±ÙØªÙ‡ ØªØ§ Ù„ÙˆØ§Ø²Ù… Ø®Ø§Ù†Ú¯ÛŒØŒ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ Ùˆ ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ø´ØºÙ„ÛŒ.',
        'about-text2': 'Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø³ÛŒØ³ØªÙ… Ø¬Ø³ØªØ¬ÙˆÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ùˆ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù…Ù„ØŒ Ø¨Ù‡ Ø±Ø§Ø­ØªÛŒ Ø¢Ù†Ú†Ù‡ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒØ¯.',
        'footer-about': 'Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§',
        'footer-contact': 'ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§',
        'footer-privacy': 'Ù‚ÙˆØ§Ù†ÛŒÙ† Ùˆ Ø­Ø±ÛŒÙ… Ø®ØµÙˆØµÛŒ',
        'footer-feedback': 'Ø§Ø±Ø³Ø§Ù„ Ù†Ø¸Ø±Ø§Øª',
        'footer-search': 'Ø¬Ø³ØªØ¬Ùˆ',
        'footer-add': 'Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ'
      },
      ps: {
        'home-btn': 'Ú©ÙˆØ±',
        'login-btn': 'Ù†Ù†ÙˆØªÙ„ / Ù†ÙˆÙ…â€ŒÙ„ÛŒÚ©Ù†Ù‡',
        'lang-btn': 'Ú˜Ø¨Ù‡',
        'theme-btn': 'Ø­Ø§Ù„Øª',
        'search-title': 'Ù¾Ù‡ Ø¨Ø§Ø²Ø§Ø± Ú©Û Ù„Ù¼ÙˆÙ†',
        'search-btn': 'Ù„Ù¼ÙˆÙ†',
        'categories-title': 'Ù¼ÙˆÙ„Û Ø¨Ø±Ø®Û',
        'cities-title': 'Ø¯ Ø§ÙØºØ§Ù†Ø³ØªØ§Ù† ÚšØ§Ø±ÙˆÙ†Ù‡',
        'recent-title': 'ÙˆØ±ÙˆØ³ØªÙŠ Ø®Ù¾Ø§Ø±Ù‡ Ø´ÙˆÙŠ Ø§Ø¹Ù„Ø§Ù†ÙˆÙ†Ù‡',
        'about-title': 'Ø¯ Ø§ÙØºØ§Ù†Ø³ØªØ§Ù† Ø¨Ø§Ø²Ø§Ø± ØªÙ‡ ÚšÙ‡ Ø±Ø§ØºÙ„Ø§Ø³Øª',
        'vehicles-cat': 'Ù…ÙˆÙ¼Ø±ÙˆÙ†Ù‡',
        'realestate-cat': 'Ø§Ù…Ù„Ø§Ú©',
        'electronics-cat': 'Ø¨Ø±Ù‚ÛŒ ØªÙˆÚ©ÙŠ',
        'jewelry-cat': 'Ú«Ø§Ú¼Û',
        'mens-clothes-cat': 'Ø¯ Ù†Ø§Ø±ÛŒÙ†Ù‡ Ú©Ø§Ù„ÙŠ',
        'womens-clothes-cat': 'Ø¯ ÚšÚÛŒÙ†Ù‡ Ú©Ø§Ù„ÙŠ',
        'kids-clothes-cat': 'Ø¯ Ù…Ø§Ø´ÙˆÙ…Ø§Ù†Ùˆ Ú©Ø§Ù„ÙŠ',
        'books-cat': 'Ø²Ø¯Ù‡â€ŒÚ©Ú“Ù‡',
        'kids-cat': 'Ø¯ Ù…Ø§Ø´ÙˆÙ…Ø§Ù†Ùˆ ØªÙˆÚ©ÙŠ',
        'home-cat': 'Ø¯ Ú©ÙˆØ±ÙˆÙ†Ùˆ ØªÙˆÚ©ÙŠ',
        'jobs-cat': 'Ø¯Ù†Ø¯Û',
        'services-cat': 'Ø®Ø¯Ù…Ø§Øª',
        'games-cat': 'Ù„ÙˆØ¨Û',
        'sports-cat': 'Ø³Ù¾ÙˆØ±Øª',
        'kabul-city': 'Ú©Ø§Ø¨Ù„',
        'herat-city': 'Ù‡Ø±Ø§Øª',
        'mazar-city': 'Ù…Ø²Ø§Ø± Ø´Ø±ÛŒÙ',
        'kandahar-city': 'Ú©Ù†Ø¯Ù‡Ø§Ø±',
        'jalalabad-city': 'Ø¬Ù„Ø§Ù„â€ŒØ¢Ø¨Ø§Ø¯',
        'ghazni-city': 'ØºØ²Ù†ÙŠ',
        'bamyan-city': 'Ø¨Ø§Ù…ÙŠØ§Ù†',
        'farah-city': 'ÙØ±Ø§Ù‡',
        'kunduz-city': 'Ú©Ù†Ø¯Ø²',
        'badakhshan-city': 'Ø¨Ø¯Ø®Ø´Ø§Ù†',
        'about-text': 'Ø¯ Ø§ÙØºØ§Ù†Ø³ØªØ§Ù† ØªØ±Ù¼ÙˆÙ„Ùˆ Ù„ÙˆÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¨Ø§Ø²Ø§Ø± Ú†Û ØªØ§Ø³Ùˆ Ú©ÙˆÙ„ÛŒ Ø´Ø¦ Ù‡Ø±Ú…Ù‡ ÙˆÙ…ÙˆÙ…Ø¦ Ú†Û ÙˆØ±ØªÙ‡ Ø§Ú“ØªÛŒØ§ Ù„Ø±Ø¦. Ø¯ Ø§Ù…Ù„Ø§Ú©Ùˆ Ø§Ùˆ Ù…ÙˆÙ¼Ø±ÙˆÙ†Ùˆ Ú…Ø®Ù‡ Ù†ÛŒÙˆÙ„Û ØªØ± Ø¯ Ú©ÙˆØ±ÙˆÙ†Ùˆ ØªÙˆÚ©ÙˆØŒ Ø¨Ø±Ù‚ÛŒ ØªÙˆÚ©Ùˆ Ø§Ùˆ Ø¯ Ú©Ø§Ø± ÙØ±ØµØªÙˆÙ†Ùˆ Ù¾ÙˆØ±Û.',
        'about-text2': 'Ø¯ Ù¾Ø±Ù…Ø®ØªÙ„Ù„ÙŠ Ù„Ù¼ÙˆÙ† Ø³ÛŒØ³Ù¼Ù… Ø§Ùˆ Ø¨Ø´Ù¾Ú“Ùˆ Ø¨Ø±Ø®Ùˆ Ù¾Ù‡ Ú©Ø§Ø±ÙˆÙ„Ùˆ Ø³Ø±Ù‡ØŒ Ù¾Ù‡ Ø§Ø³Ø§Ù†Û Ø³Ø±Ù‡ Ù‡ØºÙ‡ Ú…Ù‡ ÙˆÙ…ÙˆÙ…Ø¦ Ú†Û ØºÙˆØ§Ú“Ø¦.',
        'footer-about': 'Ø²Ù…ÙˆÚ– Ù¾Ù‡ Ø§Ú“Ù‡',
        'footer-contact': 'Ù…ÙˆÚ– Ø³Ø±Ù‡ Ø§Ú“ÛŒÚ©Ù‡',
        'footer-privacy': 'Ù‚ÙˆØ§Ù†ÛŒÙ† Ø§Ùˆ Ù…Ø­Ø±Ù…ÛŒØª',
        'footer-feedback': 'Ù†Ø¸Ø±ÛŒØ§Øª ÙˆÙ„ÛŒÚ–Ø¦',
        'footer-search': 'Ù„Ù¼ÙˆÙ†',
        'footer-add': 'Ø§Ø¹Ù„Ø§Ù† Ø«Ø¨Øª Ú©Ú“Ø¦'
      },
      en: {
        'home-btn': 'Home',
        'login-btn': 'Login / Register',
        'lang-btn': 'Language',
        'theme-btn': 'Theme',
        'search-title': 'Search in Market',
        'search-btn': 'Search',
        'categories-title': 'All Categories',
        'cities-title': 'Afghan Cities',
        'recent-title': 'Recently Posted Items',
        'about-title': 'Welcome to Afghanistan Market',
        'vehicles-cat': 'Vehicles',
        'realestate-cat': 'Real Estate',
        'electronics-cat': 'Electronics',
        'jewelry-cat': 'Jewelry',
        'mens-clothes-cat': 'Men\'s Clothing',
        'womens-clothes-cat': 'Women\'s Clothing',
        'kids-clothes-cat': 'Kids Clothing',
        'books-cat': 'Education',
        'kids-cat': 'Kids Items',
        'home-cat': 'Home Items',
        'jobs-cat': 'Jobs',
        'services-cat': 'Services',
        'games-cat': 'Games',
        'sports-cat': 'Sports',
        'kabul-city': 'Kabul',
        'herat-city': 'Herat',
        'mazar-city': 'Mazar Sharif',
        'kandahar-city': 'Kandahar',
        'jalalabad-city': 'Jalalabad',
        'ghazni-city': 'Ghazni',
        'bamyan-city': 'Bamyan',
        'farah-city': 'Farah',
        'kunduz-city': 'Kunduz',
        'badakhshan-city': 'Badakhshan',
        'about-text': 'The largest online market in Afghanistan where you can find anything you need. From real estate and vehicles to home appliances, electronics and job opportunities.',
        'about-text2': 'Using an advanced search system and comprehensive categories, easily find what you want.',
        'footer-about': 'About Us',
        'footer-contact': 'Contact Us',
        'footer-privacy': 'Privacy Policy',
        'footer-feedback': 'Send Feedback',
        'footer-search': 'Search',
        'footer-add': 'Post Ad'
      }
    };

    // Fetch and display recent items on page load
    async function fetchItems(filters = {}, limit = 8) {
      try {
        showLoading(true);
        const queryString = new URLSearchParams({...filters, limit}).toString();
        const response = await fetch(`get_items.php?${queryString}`);
        const data = await response.json();

        if (data.success) {
          renderItemsList(data.items);
        } else {
          showError('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§');
        }
      } catch (error) {
        console.error('Error fetching items:', error);
        showError('Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±');
      } finally {
        showLoading(false);
      }
    }

    function renderItemsList(items) {
      resultsGrid.innerHTML = '';

      if (items.length === 0) {
        resultsGrid.innerHTML = '<div class="no-results">Ù‡ÛŒÚ† Ø¢Ú¯Ù‡ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</div>';
        return;
      }

      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        card.style.cursor = 'pointer';
        card.innerHTML = `
          <div class="title">${escapeHtml(item.title)}</div>
          <div class="meta">${escapeHtml(item.description || '')}</div>
          <div class="price">${formatPrice(item.price)} Ø§ÙØºØ§Ù†ÛŒ</div>
          <div style="margin-top: 10px; text-align: ${document.body.style.direction === 'ltr' ? 'left' : 'right'};">
            <button class="detail-btn" style="padding: 8px 12px; border-radius: 6px; border: none; cursor: pointer; background: #ffffff; color: #6a11cb; font-weight: bold;">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª</button>
          </div>
        `;
        
        // Add click event listener for the entire card
        card.addEventListener('click', function(e) {
          e.preventDefault();
          window.location.href = `item_detail.php?id=${item.id}`;
        });
        
        card.dataset.item = JSON.stringify(item);
        resultsGrid.appendChild(card);
      });
    }

    function showLoading(show) {
      loadingMessage.style.display = show ? 'block' : 'none';
    }

    function showError(message) {
      resultsGrid.innerHTML = `<div class="no-results">${message}</div>`;
    }

    function escapeHtml(text) {
      const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
      };
      return (text || '').replace(/[&<>"']/g, function(m) { return map[m]; });
    }

    function formatPrice(price) {
      return parseFloat(price).toLocaleString('fa-IR');
    }

    function openDetail(itemId) {
      window.location.href = `item_detail.php?id=${itemId}`;
    }

    function getQueryParams() {
      const params = new URLSearchParams(window.location.search);
      return {
        category: params.get('category'),
        city: params.get('city'),
        q: params.get('q')
      };
    }

    function setLanguage(lang) {
      currentLang = lang;

      const html = document.getElementById('html-element');
      const body = document.body;
      const selector = document.getElementById('language-selector');

      // Update language attribute
      html.lang = currentLang;
      selector.value = currentLang;

      // Update direction and font
      if (currentLang === 'en') {
        body.classList.add('ltr');
        body.classList.remove('pashto');
        body.style.direction = 'ltr';
      } else {
        body.classList.remove('ltr');
        body.style.direction = 'rtl';

        if (currentLang === 'ps') {
          body.classList.add('pashto');
        } else {
          body.classList.remove('pashto');
        }
      }

      // Update all text elements
      const translation = translations[currentLang];
      for (const [key, value] of Object.entries(translation)) {
        const element = document.getElementById(key);
        if (element) {
          element.textContent = value;
        }
      }

      // Update placeholder
      const searchInput = document.getElementById('searchInput');
      if (currentLang === 'fa') {
        searchInput.placeholder = 'Ú†ÛŒ Ù…ÛŒâ€ŒÚ¯Ø±Ø¯ÛŒØŸ';
      } else if (currentLang === 'ps') {
        searchInput.placeholder = 'Ú…Ù‡ ØºÙˆØ§Ú“ÛØŸ';
      } else {
        searchInput.placeholder = 'What are you looking for?';
      }

      // Save preference
      localStorage.setItem('afghanMarketLang', currentLang);
    }

    // Load saved language preference
    function loadLanguagePreference() {
      const savedLang = localStorage.getItem('afghanMarketLang') || 'fa';
      setLanguage(savedLang);
    }

    function toggleTheme() {
      document.body.classList.toggle('dark-mode');
    }

    function handleSearch(event) {
      event.preventDefault();
      const query = document.getElementById('searchInput').value;
      const category = document.getElementById('categorySelect').value;

      let searchUrl = 'search.php?';
      if (query) searchUrl += 'q=' + encodeURIComponent(query) + '&';
      if (category) searchUrl += 'category=' + category + '&';

      window.location.href = searchUrl;
    }

    function searchByCategory(category) {
      window.location.href = 'search.php?category=' + category;
    }

    function searchCity(city) {
      window.location.href = 'search.php?city=' + city;
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      // Load saved language preference
      loadLanguagePreference();

      // Load recent items on page load
      fetchItems({}, 8);

      // Check if there are URL parameters for initial search
      const params = getQueryParams();
      if (params.category || params.city || params.q) {
        fetchItems({
          category: params.category || null,
          city: params.city || null,
          search: params.q || null
        });
      }
    });
  </script>
</body>
</html>